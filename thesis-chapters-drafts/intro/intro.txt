IPv6 is the designated successor of IPv4, which was specified and implemented in a context with a limited number of users and hosts, most of them circumscribed to the scientific world. The most relevant aspect of this first specification is the 32 bit address space, which in that context was considered sufficient to include the needs in terms of required address.\\
Since the first specifications, the communication between hosts evolved in a way that was not predictable; new networks arose to fulfill the needs of organizations and enterprises, modeling the Internet of today. In this new context, researcher and professional involved in the IT field realized that the new requirements could not be satisfied by adding new specifications to the existing IPv4, but that there was the need to specify a new protocol, based on the new requirements of the actual context. 

One of the most visible enhancements in IPv6 regards the increasing number of addresses, changing from 32 to 128 bit. This specification addresses the requirement for more devices connecting to the Internet and it is also a foresight for the future. Although this is a foundamental feature of the new IP protocol version, it is not the only enhancement and change of the protocol, which has been rethought in many other aspects. One of them is the ICMP protocol.\\
As IPv4, IPv6 relies on the ICMP protocol, called ICMPv6 in the new version, to provide control and error messages. Furthermore, ICMP in IPv6 acquired new relevance because it is used by other protocols, such as the Neighbor Discovering Protocol, which are fundamental for networking functionalities of an IPv6 node.\\


From a security point of view, ICMPv6 messages cannot be totally filtered by security devices, which for IPv4 is one of the main mitigation techniques. This particularity introduces new exploitation possibilities for 
an attacker.



IPv6 is the designated successor of IPv4, a protocol specified and implemented in a context with a limited number of users and hosts, most of them circumscribed to the scientific world. The need of a new protocol arose because of a changed context: the evolution of new powerful devices and their spread in many field of the society, which in turn modified the behavior and the requests of new entities, being them individuals or big organizations. The new IP protocol has been specified and rewritten in many aspects, taking in consideration the evolution of the requirements and the future needs of the involved actors.\\
IPv6 (citation RFC), with respect to his predecessor, changed in many aspects. The headers have been modified to accomodate new functionalities and improved capabilities, mainly it provides "expanded Addressing Capabilities", "header Format Simplification", "improved Support for Extensions and Options", "flow Labeling Capability", and "authentication and Privacy Capabilities". One of the most relevant aspect is the increased address space from 32 bits to 128 bits, which deals with the demand of new communicating devices to fulfill organization's requirements.\\
Despite IPv6 specifications have been formalized in 1998, its spread and adoption by the world community is far from being accomplished. Among the many possible reasons that could explain this behavior, two of them deserve particular attention. The first one is related to the lack of address space, which has been mitigated by the introduction of NAT (citation RFC): the use of NAT allows to use a private (citation ??), not routeable, address space for the internal network of an organization, and the use of one, or limited number, of public IPv4 address at the network boundary. This technique mitigated the need to introduce the 128 bits address space of IPv6, because organization's requirements to allocate new IPv4 address from IANA (footnote) have been reduced. The second reason is related to the application and services offered by organizations. Networked application have been written for, and tested against, IPv4. Many of them represents IT assets which are critical for the business assets and goals of enterprises: the introduction of new applications written for IPv6 represents a great effort in terms of financial investment, time for implementation and testing, and use of enterprises' resources.\\

The IPv6 world is composed by a number of protocols, which are used by nodes to fulfill their requirements: some of them, with respect to their IPv4 version, have been obsoleted by new concepts and specifications of IPv6, while others have been rewritten with few changes. In this galaxy of protocols, one of them, present also in his version 4, deserve particular attention: ICMPv6.\\
ICMPv6, despite it shares almost the same naming convention with respect with the predecessor, could be considered a new protocol for a number of reasons, which make it a critical subject of research by the International Community. The reasons behind its criticality arise because it holds a backward compatibility with the functions of its version 4, but at the same time introduces a number of new functionalitities, and responsibilities, for the correct behavior of an IPv6 node.\\

ICMPv4 has been used by IPv4 to manage error and informational messages to allow for a better management and troubleshooting of the network. While it is an important aspect of the network and it has been used by Network Administrators to manage network issues, it is not crucial for the correct working of the communication. This version has been tested for many years, with the identification of vulnerabilities and the consequent potentiality of exploitation by malicious actors. Many best practices (citation cisco) suggested to filter ICMPv4 messages at network boundaries to mitigate the risk of the exploitation of some vulnerabilities without compromising the network functionalities. Nowadays the network evolved in more sophisticated designs and new concepts, like BYOD and public wifi, partially obsolete the very same concept of boundaries, bringing new threats to the internal network. The security controls could no more be applied only at the boundaries, but must be introduced in other segments of the network. This new security controls applies to the ICMPv4 protocol as well, and filtering must be introduced where such messages are not strictly required by Network Administrators.\\

“ICMPv6 is used by IPv6 nodes to report errors encountered in processing packets,
and to perform other internet-layer functions, such as diagnostics (ICMPv6 ”ping”).
ICMPv6 is an integral part of IPv6, and the base protocol (all the messages and
behavior required by this specification) MUST be fully implemented by every IPv6
node.” [1]
This paragraph of RFC 4443 describes broadly the purpose of ICMPv6, but the
most important part is the last sentence, which states that the base protocol must
be fully implemented by every IPv6 node. In the Request For Comments terminol-
ogy, the word “must, or the terms REQUIRED or SHALL, mean that the definition
is an absolute requirement of the specification“ [2]. The real distinction between
ICMPv4 and ICMPv6 in this context is formal: RFC 792 states that ”ICMP ... must
be implemented by every IP module“[3], which means that an implementation is
required. The ICMPv6 specification is more precise because it refers to every IPv6
node, which covers the implementation inside the module, but also, with the concept
of node, implies that the node must be able to use its functionalities.
This is a fundamental distinction, because the best practices in use with ICMPv4,
with ICMPv6 are no more relevant, at
least with some message types. As it is written in this paper[4], which cites RFC
4861[5], ”ICMPv6 is used for basic functionalities and used by other IPv6 proto-
cols ... Neighbor Discovery Protocol is a protocol used with IPv6 to perform
various tasks like router discovery, auto address configuration of a node, neighbor
discovery, Duplicate Address Detection, determining the Link Layer addresses of
other nodes, address prefix discovery, and maintaining routing information about
the paths to other active neighbor nodes“.

Another important aspect to take into consideration when dealing with IPv6 in general, and with ICMPv6 in particular, is the transition from version 4 to version 6. For the reasons mentioned above, many organizations delayed as much as they could the deployment of full IPv6 networks. Nevertheless the scientific community continued to improve the new version and the its related protocols, and the Operating Systems started to include them in their network implementations. At the same time, techniques to allow a slow transition have been developed: examples of that are the dual stack, the presence and coexistence of both protocol versions in the same node, or the encapsulation of IPv6 inside IPv4, in those network segments where IPv6 has not been deployed yet. In addition, in many OSs, IPv6 is active by default and preferred over IPv4.\\
These aspects must not be underestimated and show again how critical and urgent is an analysis in depth of ICMPv6: not only this protocol is fundamental for IPv6 and the best practices can be used only against the old version, but it is already present and activated in the OSs that users employ in their everyday life. This last distinction is very important because it introduces another aspect to take into account: network administrator and security officer must not deal only with threats deriving from the exploitation of technical vunlerabilities, but also with behavioral procedures shaped around years of practice. IPv6 and ICMPv6 are not protocol that will be introduced in the future, they are present and we must deal with them now. Countermeasures must be in place, at the network boundaries and inside critical network segments above all, that take into consideration version 6 of the protocols. Such countermeasures must follow new best practices carefully shaped around the new version.


The contribution




